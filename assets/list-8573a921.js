import{g as le,h as se,N as re,ab as S,aA as ie,r as i,S as de,o as c,c as ue,a as t,w as o,u as n,af as M,T as k,b as d,t as ce,f as _,x as V,ai as me,a2 as z,E as $,P as pe,k as _e,e as fe,ae as E,_ as ge,d as D}from"./index-2063e8c9.js";import{_ as be}from"./index-b7719e05.js";import{_ as he}from"./index.vue_vue_type_script_setup_true_lang-0d86cdd2.js";import{a as w}from"./index.vue_vue_type_script_setup_true_lang-dd1f0938.js";import{u as ve}from"./usePagination-4a1ec3e2.js";import{u as we}from"./useTabbar-4ad52ae9.js";const U=le({name:"PagesExampleManagerList",__name:"list",setup(Ce){const{pagination:f,getParams:B,onSizeChange:K,onCurrentChange:N,onSortChange:A}=ve(),P=we(),e=se({loading:!1,tableAutoHeight:!1,formMode:"router",formModeProps:{visible:!1,id:""},search:{account:"",name:"",mobile:"",sex:""},searchFold:!0,batch:{enable:!0,selectionDataList:[]},dataList:[]});re(()=>{m(),e.value.formMode==="router"&&S.on("get-data-list",()=>{m()})}),ie(()=>{e.value.formMode==="router"&&S.off("get-data-list")});function m(){e.value.loading=!0;const l={...B(),...e.value.search.account&&{account:e.value.search.account},...e.value.search.name&&{name:e.value.search.name},...e.value.search.mobile&&{mobile:e.value.search.mobile},...e.value.search.sex!==""&&{sex:e.value.search.sex}};w.list(l).then(a=>{e.value.loading=!1,e.value.dataList=a.data.list,e.value.dataList.forEach(C=>{C.statusLoading=!1}),f.value.total=a.data.total})}function F(l){K(l).then(()=>m())}function u(l=1){N(l).then(()=>m())}function T({prop:l,order:a}){A(l,a).then(()=>m())}function G(){e.value.formMode==="router"?P.open({name:"pagesExampleGeneralManagerCreate"}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0)}function H(l){e.value.formMode==="router"?P.open({name:"pagesExampleGeneralManagerEdit",params:{id:l.id}}):(e.value.formModeProps.id=l.id,e.value.formModeProps.visible=!0)}function R(l){return new Promise(a=>{z.confirm(`确认${l.status?"禁用":"启用"}「${l.account}」吗？`,"确认信息").then(()=>{l.statusLoading=!0,w.changeStatus({id:l.id,status:!l.status}).then(()=>(l.statusLoading=!1,$.success({message:`模拟${l.status?"禁用":"启用"}成功`,center:!0}),a(!0))).catch(()=>(l.statusLoading=!1,a(!1)))}).catch(()=>a(!1))})}function I(l){z.confirm(`确认将「${l.account}」的密码重置为 “123456” 吗？`,"确认信息").then(()=>{w.passwordReset(l.id).then(()=>{$.success({message:"模拟重置成功",center:!0})})}).catch(()=>{})}function O(l){z.confirm(`确认删除「${l.account}」管理员吗？`,"确认信息").then(()=>{w.delete(l.id).then(()=>{m(),$.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}function j(l,a){switch(l){case"resetPassword":I(a);break;case"delete":O(a);break}}return(l,a)=>{const C=pe,y=i("el-input"),b=i("el-form-item"),h=i("el-radio-button"),q=i("el-radio-group"),v=_e,g=i("el-button"),J=i("el-form"),Q=be,W=i("el-divider"),X=i("el-space"),p=i("el-table-column"),x=i("el-tag"),Y=i("el-switch"),L=i("el-dropdown-item"),Z=i("el-dropdown-menu"),ee=i("el-dropdown"),ae=i("el-table"),te=i("el-pagination"),oe=fe,ne=de("loading");return c(),ue("div",{class:me({"absolute-container":n(e).tableAutoHeight})},[t(C,{title:"管理员管理",content:"页面数据为 Mock 示例数据，非真实数据。"}),t(oe,null,{default:o(()=>[t(Q,{fold:n(e).searchFold,"show-toggle":!1},{default:o(({fold:r})=>[t(J,{model:n(e).search,size:"default","label-width":"100px",inline:"","inline-message":"",class:"search-form"},{default:o(()=>[t(b,{label:"帐号"},{default:o(()=>[t(y,{modelValue:n(e).search.account,"onUpdate:modelValue":a[0]||(a[0]=s=>n(e).search.account=s),placeholder:"请输入帐号，支持模糊查询",clearable:"",onKeydown:a[1]||(a[1]=M(s=>u(),["enter"])),onClear:a[2]||(a[2]=s=>u())},null,8,["modelValue"])]),_:1}),t(b,{label:"姓名"},{default:o(()=>[t(y,{modelValue:n(e).search.name,"onUpdate:modelValue":a[3]||(a[3]=s=>n(e).search.name=s),placeholder:"请输入姓名，支持模糊查询",clearable:"",onKeydown:a[4]||(a[4]=M(s=>u(),["enter"])),onClear:a[5]||(a[5]=s=>u())},null,8,["modelValue"])]),_:1}),k(t(b,{label:"手机号"},{default:o(()=>[t(y,{modelValue:n(e).search.mobile,"onUpdate:modelValue":a[6]||(a[6]=s=>n(e).search.mobile=s),placeholder:"请输入手机号",clearable:"",onKeydown:a[7]||(a[7]=M(s=>u(),["enter"])),onClear:a[8]||(a[8]=s=>u())},null,8,["modelValue"])]),_:2},1536),[[E,!r]]),k(t(b,{label:"性别"},{default:o(()=>[t(q,{modelValue:n(e).search.sex,"onUpdate:modelValue":a[9]||(a[9]=s=>n(e).search.sex=s),onChange:a[10]||(a[10]=s=>u())},{default:o(()=>[t(h,{label:""},{default:o(()=>[d(" 全部 ")]),_:1}),t(h,{label:1},{default:o(()=>[d(" 男 ")]),_:1}),t(h,{label:0},{default:o(()=>[d(" 女 ")]),_:1}),t(h,{label:2},{default:o(()=>[d(" 保密 ")]),_:1})]),_:1},8,["modelValue"])]),_:2},1536),[[E,!r]]),t(b,null,{default:o(()=>[t(g,{type:"primary",onClick:a[11]||(a[11]=s=>u())},{icon:o(()=>[t(v,{name:"ep:search"})]),default:o(()=>[d(" 筛选 ")]),_:1}),t(g,{link:"",onClick:s=>n(e).searchFold=!r},{icon:o(()=>[t(v,{name:r?"ep:caret-bottom":"ep:caret-top"},null,8,["name"])]),default:o(()=>[d(" "+ce(r?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1},8,["fold"]),t(W,{"border-style":"dashed"}),t(X,{wrap:""},{default:o(()=>[t(g,{type:"primary",size:"default",onClick:G},{icon:o(()=>[t(v,{name:"ep:plus"})]),default:o(()=>[d(" 新增管理员 ")]),_:1}),n(e).batch.enable?(c(),_(g,{key:0,size:"default",disabled:!n(e).batch.selectionDataList.length},{default:o(()=>[d(" 批量操作 ")]),_:1},8,["disabled"])):V("",!0)]),_:1}),k((c(),_(ae,{class:"list-table",data:n(e).dataList,border:"",stripe:"","highlight-current-row":"",height:"100%",onSortChange:T,onSelectionChange:a[12]||(a[12]=r=>n(e).batch.selectionDataList=r)},{default:o(()=>[n(e).batch.enable?(c(),_(p,{key:0,type:"selection",align:"center",fixed:""})):V("",!0),t(p,{prop:"account",sortable:"",label:"帐号"}),t(p,{prop:"name",label:"姓名",width:"100",align:"center"}),t(p,{prop:"sex",label:"性别",width:"100",align:"center"},{default:o(r=>[r.row.sex===1?(c(),_(x,{key:0,type:"success",size:"small"},{default:o(()=>[d(" 男 ")]),_:1})):r.row.sex===0?(c(),_(x,{key:1,type:"warning",size:"small"},{default:o(()=>[d(" 女 ")]),_:1})):(c(),_(x,{key:2,type:"info",size:"small"},{default:o(()=>[d(" 保密 ")]),_:1}))]),_:1}),t(p,{prop:"mobile",label:"手机号",width:"150",align:"center"}),t(p,{label:"状态",width:"100",align:"center"},{default:o(r=>[t(Y,{modelValue:r.row.status,"onUpdate:modelValue":s=>r.row.status=s,loading:r.row.statusLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>R(r.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),t(p,{label:"操作",width:"200",align:"center",fixed:"right"},{default:o(r=>[t(g,{type:"primary",size:"small",plain:"",onClick:s=>H(r.row)},{default:o(()=>[d(" 编辑 ")]),_:2},1032,["onClick"]),t(ee,{onCommand:s=>j(s,r.row)},{dropdown:o(()=>[t(Z,null,{default:o(()=>[t(L,{command:"resetPassword"},{default:o(()=>[d(" 重置密码 ")]),_:1}),t(L,{command:"delete",divided:""},{default:o(()=>[d(" 删除 ")]),_:1})]),_:1})]),default:o(()=>[t(g,{size:"small"},{default:o(()=>[d(" 更多操作 "),t(v,{name:"ep:arrow-down",class:"el-icon--right"})]),_:1})]),_:2},1032,["onCommand"])]),_:1})]),_:1},8,["data"])),[[ne,n(e).loading]]),t(te,{"current-page":n(f).page,total:n(f).total,"page-size":n(f).size,"page-sizes":n(f).sizes,layout:n(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:u,onSizeChange:F},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),n(e).formMode==="dialog"||n(e).formMode==="drawer"?(c(),_(he,{key:0,id:n(e).formModeProps.id,modelValue:n(e).formModeProps.visible,"onUpdate:modelValue":a[13]||(a[13]=r=>n(e).formModeProps.visible=r),mode:n(e).formMode,onSuccess:m},null,8,["id","modelValue","mode"])):V("",!0)],2)}}});typeof D=="function"&&D(U);const $e=ge(U,[["__scopeId","data-v-51aab7e4"]]);export{$e as default};
