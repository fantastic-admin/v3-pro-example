import{g as pe,m as fe,z as he,p as ve,am as _e,B as ge,A as be,v as me,I as ye,h as k,an as ke,q as Se,K as W,ao as S,N as we,ab as O,ap as X,aq as Y,r as N,o as f,c as v,l as _,ag as K,u as s,a as r,w as c,b as g,t as h,i as Z,x as L,af as U,F as ee,j as te,ai as ae,k as Te,f as Ce,_ as Re}from"./index-2063e8c9.js";const ze={class:"container"},Ie={key:0,class:"switch-type"},xe={key:1,class:"tips"},Be={key:0,class:"tip"},Ve={class:"tip"},Le={class:"tip"},Ee={key:1,class:"tip"},He=["onClick","onMouseover"],Me={class:"info"},De={class:"title"},Ne={class:"breadcrumb"},Ke={class:"path"},Ue=pe({name:"Search",__name:"index",setup($e){const{t:w}=fe(),ne=he(),d=ve(),se=_e(),le=ge(),oe=be(),E=me(ye,Function,!0),b=k(!1),H=k(),T=k(""),I=k([]),i=k(-1),$=k(),m=k(),x=k([]);function re(t){return x.value.push(t)}ke(()=>{x.value=[]});const z=Se(()=>{let t=[];return t=I.value.filter(e=>{let o=!1;return E(e.i18n,e.title).toString().includes(T.value)&&(o=!0),e.path.includes(T.value)&&(o=!0),e.breadcrumb.some(n=>E(n.i18n,n.title).toString().includes(T.value))&&(o=!0),o}),t});W(()=>b.value,t=>{t?(document.body.classList.add("overflow-hidden"),m.value&&(m.value.scrollTop=0),S("up",j),S("down",F),S("enter",q),setTimeout(()=>{$.value.focus()},500)):(document.body.classList.remove("overflow-hidden"),S.unbind("up",j),S.unbind("down",F),S.unbind("enter",q),setTimeout(()=>{T.value="",i.value=-1},500))}),W(()=>z.value,()=>{i.value=-1,A()}),we(()=>{O.on("global-search-toggle",t=>{b.value||M(t),b.value=!b.value}),S("alt+s",t=>{d.settings.navSearch.enable&&d.settings.navSearch.enableHotkeys&&(t.preventDefault(),M(),b.value=!0)}),S("esc",t=>{d.settings.navSearch.enable&&d.settings.navSearch.enableHotkeys&&(t.preventDefault(),b.value=!1)}),M()});function ie(t){$.value.focus(),M(t)}function M(t="menu"){switch(H.value=t,I.value=[],t){case"menu":d.settings.app.routeBaseOn!=="filesystem"?se.routes.forEach(e=>{e.children&&J(e.children)}):le.menus.forEach(e=>{P(e.children)});break;case"tab":ce(oe.list);break}}function ue(t){var o;let e=!0;return(o=t.children)!=null&&o.every(n=>{var a;return((a=n.meta)==null?void 0:a.sidebar)===!1})&&(e=!1),e}function J(t,e,o,n){t.forEach(a=>{var C,u,l,y,p,R,B,V,G,Q;if(((C=a.meta)==null?void 0:C.sidebar)!==!1){const D=X(n)||[];a.children&&ue(a)?(D.push({title:(u=a.meta)==null?void 0:u.title,i18n:(l=a.meta)==null?void 0:l.i18n}),J(a.children,Y(e,a.path),((y=a.meta)==null?void 0:y.icon)??o,D)):(D.push({title:(p=a.meta)==null?void 0:p.title,i18n:(R=a.meta)==null?void 0:R.i18n}),I.value.push({path:Y(e,a.path),icon:((B=a.meta)==null?void 0:B.icon)??o,title:(V=a.meta)==null?void 0:V.title,i18n:(G=a.meta)==null?void 0:G.i18n,link:(Q=a.meta)==null?void 0:Q.link,breadcrumb:D}))}})}function P(t,e,o){t.forEach(n=>{var C,u,l,y,p,R,B,V;const a=X(o)||[];n.children&&n.children.length>0?(a.push({title:(C=n.meta)==null?void 0:C.title,i18n:(u=n.meta)==null?void 0:u.i18n}),P(n.children,((l=n.meta)==null?void 0:l.icon)??e,a)):(a.push({title:(y=n.meta)==null?void 0:y.title,i18n:(p=n.meta)==null?void 0:p.i18n}),I.value.push({icon:((R=n.meta)==null?void 0:R.icon)??e,title:(B=n.meta)==null?void 0:B.title,path:n.path,i18n:(V=n.meta)==null?void 0:V.i18n,breadcrumb:a}))})}function ce(t){t.forEach(e=>{I.value.push({icon:e.icon,title:e.title,path:e.fullPath,i18n:e.i18n,breadcrumb:[]})})}function j(){z.value.length&&(i.value-=1,i.value<0&&(i.value=z.value.length-1),A())}function F(){z.value.length&&(i.value+=1,i.value>z.value.length-1&&(i.value=0),A())}function q(){i.value!==-1&&x.value[i.value].click()}function A(){if(m.value){let t=0;if(i.value!==-1){t=m.value.scrollTop;const e=x.value[i.value].offsetTop,o=x.value[i.value].clientHeight,n=m.value.scrollTop,a=m.value.clientHeight;e+o>n+a?t=e+o-a:e<=n&&(t=e)}m.value.scrollTo({top:t})}}function de(t,e){e?window.open(e,"_blank"):ne.push(t)}return(t,e)=>{const o=N("el-radio-button"),n=N("el-radio-group"),a=Te,C=N("el-input"),u=N("el-tag");return f(),v("div",{id:"search",class:ae({searching:s(b)}),onClick:e[4]||(e[4]=l=>s(b)&&s(O).emit("global-search-toggle"))},[_("div",ze,[_("div",{class:"search-box",onClick:e[3]||(e[3]=K(()=>{},["stop"]))},[s(d).settings.tabbar.enable?(f(),v("div",Ie,[r(n,{modelValue:s(H),"onUpdate:modelValue":e[0]||(e[0]=l=>Z(H)?H.value=l:null),size:"large",onChange:ie},{default:c(()=>[r(o,{label:"menu"},{default:c(()=>[g(h(s(w)("app.search.type.menu")),1)]),_:1}),r(o,{label:"tab"},{default:c(()=>[g(h(s(w)("app.search.type.tab")),1)]),_:1})]),_:1},8,["modelValue"])])):L("",!0),r(C,{ref_key:"searchInputRef",ref:$,modelValue:s(T),"onUpdate:modelValue":e[1]||(e[1]=l=>Z(T)?T.value=l:null),placeholder:s(w)("app.search.input"),clearable:"",onKeydown:[e[2]||(e[2]=U(l=>s(O).emit("global-search-toggle"),["esc"])),U(K(j,["prevent"]),["up"]),U(K(F,["prevent"]),["down"]),U(K(q,["prevent"]),["enter"])]},{prefix:c(()=>[r(a,{name:"ep:search"})]),_:1},8,["modelValue","placeholder","onKeydown"]),s(d).mode==="pc"?(f(),v("div",xe,[s(d).settings.navSearch.enableHotkeys?(f(),v("div",Be,[r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(d).os==="mac"?"âŒ¥":"Alt")+" + S ",1)]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(w)("app.search.alt_s")),1)]),_:1})])):L("",!0),_("div",Ve,[r(u,{type:"info",size:"large"},{default:c(()=>[r(a,{name:"ant-design:caret-up-filled"})]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[r(a,{name:"ant-design:caret-down-filled"})]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(w)("app.search.up_down")),1)]),_:1})]),_("div",Le,[r(u,{type:"info",size:"large"},{default:c(()=>[r(a,{name:"ion:md-return-left"})]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(w)("app.search.enter")),1)]),_:1})]),s(d).settings.navSearch.enableHotkeys?(f(),v("div",Ee,[r(u,{type:"info",size:"large"},{default:c(()=>[g(" ESC ")]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(w)("app.search.esc")),1)]),_:1})])):L("",!0)])):L("",!0)]),_("div",{ref_key:"searchResultRef",ref:m,class:"result"},[(f(!0),v(ee,null,te(s(z),(l,y)=>(f(),v("a",{ref_for:!0,ref:re,key:l.path,class:ae(["item",{actived:y===s(i)}]),onClick:p=>de(l.path,l.link),onMouseover:p=>i.value=y},[l.icon?(f(),Ce(a,{key:0,name:l.icon,class:"icon"},null,8,["name"])):L("",!0),_("div",Me,[_("div",De,h(s(E)(l.i18n,l.title)),1),_("div",Ne,[(f(!0),v(ee,null,te(l.breadcrumb,(p,R)=>(f(),v("span",{key:R},[g(h(s(E)(p.i18n,p.title))+" ",1),r(a,{name:"ep:arrow-right"})]))),128))]),_("div",Ke,h(l.path),1)])],42,He))),128))],512)])],2)}}});const Fe=Re(Ue,[["__scopeId","data-v-ca891ac8"]]);export{Fe as default};
