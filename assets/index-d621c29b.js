import{g as j,h as E,r as n,o as r,c as h,a as t,w as g,f as m,l as o,aw as p,ag as f,T as U,ae as O,u as c,x as _,E as w,k as D,_ as I}from"./index-2063e8c9.js";const L={class:"upload-container"},R={key:1,class:"image"},T={class:"mask"},P={class:"actions"},q=["onClick"],A=["onClick"],F={key:0,class:"el-upload__tip"},G={style:{display:"inline-block"}},H=j({name:"ImageUpload",__name:"index",props:{action:{},headers:{},data:{},name:{default:"file"},url:{default:""},size:{default:2},width:{default:150},height:{default:150},placeholder:{default:""},notip:{type:Boolean,default:!1},ext:{default:()=>["jpg","png","gif","bmp"]}},emits:["update:url","onSuccess"],setup(v,{emit:y}){const d=v,u=y,s=E({imageViewerVisible:!1,progress:{preview:"",percent:0}});function k(){s.value.imageViewerVisible=!0}function $(){s.value.imageViewerVisible=!1}function V(){u("update:url","")}const b=e=>{const l=e.name.split(".").at(-1)??"",i=d.ext.includes(l),a=e.size/1024/1024<d.size;return i||w.error(`上传图片只支持 ${d.ext.join(" / ")} 格式！`),a||w.error(`上传图片大小不能超过 ${d.size}MB！`),i&&a&&(s.value.progress.preview=URL.createObjectURL(e)),i&&a},C=e=>{s.value.progress.percent=~~e.percent},z=e=>{s.value.progress.preview="",s.value.progress.percent=0,u("onSuccess",e)};return(e,B)=>{const l=D,i=n("el-image"),a=n("el-progress"),S=n("el-upload"),M=n("el-alert"),N=n("el-image-viewer");return r(),h("div",L,[t(S,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":b,"on-progress":C,"on-success":z,drag:"",class:"image-upload"},{default:g(()=>[e.url===""?(r(),m(i,{key:0,src:e.url===""?e.placeholder:e.url,style:p(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},{error:g(()=>[o("div",{class:"image-slot",style:p(`width:${e.width}px;height:${e.height}px;`)},[t(l,{name:"ep:plus"})],4)]),_:1},8,["src","style"])):(r(),h("div",R,[t(i,{src:e.url,style:p(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),o("div",T,[o("div",P,[o("span",{title:"预览",onClick:f(k,["stop"])},[t(l,{name:"ep:zoom-in"})],8,q),o("span",{title:"移除",onClick:f(V,["stop"])},[t(l,{name:"ep:delete"})],8,A)])])])),U(o("div",{class:"progress",style:p(`width:${e.width}px;height:${e.height}px;`)},[t(i,{src:c(s).progress.preview,style:p(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),t(a,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:c(s).progress.percent},null,8,["width","percentage"])],4),[[O,e.url===""&&c(s).progress.percent]])]),_:1},8,["headers","action","data","name"]),e.notip?_("",!0):(r(),h("div",F,[o("div",G,[t(M,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，且图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),c(s).imageViewerVisible?(r(),m(N,{key:1,"url-list":[e.url],teleported:"",onClose:$},null,8,["url-list"])):_("",!0)])}}});const K=I(H,[["__scopeId","data-v-d027d60e"]]);export{K as _};
