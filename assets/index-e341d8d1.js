import{_ as me}from"./index-0ccd1521.js";import{g as fe,h as D,N as ge,K as T,r as u,S as ve,o as V,c as he,a as n,w as d,b as x,l as v,u as i,t as E,ag as w,T as S,ae as A,f as z,x as U,i as be,a2 as N,E as $,P as ye,k as Ce,$ as ke,a0 as De,_ as Ve,d as F}from"./index-2063e8c9.js";import xe from"./index-4910d6a5.js";import Ie from"./index-f871a1c3.js";import{_ as Le}from"./index.vue_vue_type_script_setup_true_lang-a4afe5e9.js";import{a as C}from"./dictionary-c7d0e12e.js";import{u as ze}from"./usePagination-4a1ec3e2.js";const Ne=I=>(ke("data-v-47ec8ebb"),I=I(),De(),I),$e={class:"absolute-container"},Ee={class:"page-main"},we={class:"custom-tree-node"},Se=["title"],Ue={class:"code"},Me={class:"actions"},Be={class:"container"},Pe={class:"container"},Re=Ne(()=>v("div",{class:"empty"}," 请在左侧新增或选择一个字典 ",-1)),Te=[Re],K=fe({name:"PagesExampleDictionary",__name:"index",setup(I){const M=D(),a=D({search:"",tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""}}),{pagination:p,getParams:j,onSizeChange:q,onCurrentChange:G,onSortChange:H}=ze();p.value.size=20,p.value.sizes=[20,50,100];const J=D(),o=D({loading:!1,search:{dictionaryId:"",title:""},dataList:[],selectionDataList:[],dialog:{visible:!1,id:""}});function B(){o.value.search.dictionaryId="",C.list().then(e=>{a.value.tree=e.data})}ge(()=>{B()}),T(()=>a.value.search,e=>{M.value.filter(e)});function O(e,t){return e?t.label.includes(e):!0}function P(e){a.value.currentData=e,a.value.dialog.parentId=(e==null?void 0:e.id)??"",a.value.dialog.id="",a.value.dialog.visible=!0}function Q(e,t){a.value.currentNode=e,a.value.currentData=t,a.value.dialog.parentId=e.parent.data.id??"",a.value.dialog.id=t.id,a.value.dialog.visible=!0}function W(e,t){N.confirm(`确认删除「${t.label}」吗？`,"确认信息").then(()=>{C.delete(t.id).then(()=>{$.success({message:"模拟删除成功",center:!0});const s=e.parent,r=s.data.children||s.data,c=r.findIndex(_=>_.id===t.id);r.splice(c,1),a.value.tree=[...a.value.tree]})})}function X(e){a.value.currentData?(a.value.currentData.children||(a.value.currentData.children=[]),a.value.currentData.children.push({id:e.id,label:e.label,code:e.code})):a.value.tree.push({id:e.id,label:e.label,code:e.code})}function Y(e,t){if(a.value.currentNode&&a.value.currentData)if((a.value.currentNode.parent.data.id??"")===t)a.value.currentData.label=e.label,a.value.currentData.code=e.code;else{const s=a.value.currentNode.parent,r=s.data.children||s.data,c=r.findIndex(_=>_.id===e.id);if(r[c].label=e.label,r[c].code=e.code,t){const _=(h,L)=>{for(const y in h){if(h[y].id===L)return h[y];if(h[y].children){const f=_(h[y].children,L);if(f)return f}}},b=_(a.value.tree,t);b.children||(b.children=[]),b.children.push(r[c])}else a.value.tree.push(r[c]);r.splice(c,1)}}function Z(e){p.value.page=1,o.value.search.dictionaryId=e.id}T(()=>o.value.search.dictionaryId,()=>{m()});function m(){o.value.loading=!0;const e={...j(),dictionary_id:o.value.search.dictionaryId,...o.value.search.title&&{title:o.value.search.title}};C.itemList(e).then(t=>{o.value.loading=!1,o.value.dataList=t.data.list,o.value.dataList.forEach(s=>{s.enableLoading=!1}),p.value.total=t.data.total})}function ee(e){return new Promise(t=>{N.confirm(`确认${e.enable?"禁用":"启用"}「${e.name}」吗？`,"确认信息").then(()=>{e.enableLoading=!0,C.itemChangeEnable({id:e.id,enable:!e.enable}).then(()=>(e.enableLoading=!1,$.success({message:`模拟${e.enable?"禁用":"启用"}成功`,center:!0}),t(!0))).catch(()=>(e.enableLoading=!1,t(!1)))}).catch(()=>t(!1))})}function te(e){q(e).then(()=>m())}function ae(e=1){G(e).then(()=>m())}function ne({prop:e,order:t}){H(e,t).then(()=>m())}function ie(){o.value.dialog.id="",o.value.dialog.visible=!0}function le(e){o.value.dialog.id=e.id,o.value.dialog.visible=!0}function oe(e){N.confirm(`确认删除「${e.name}」吗？`,"确认信息").then(()=>{C.itemDelete(e.id).then(()=>{m(),$.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}function de(e){N.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{C.itemDelete(e.map(t=>t.id)).then(()=>{m(),$.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}const k=D(!1);return(e,t)=>{const s=u("el-button"),r=ye,c=Ce,_=u("el-button-group"),b=u("el-input"),h=u("ElTree"),L=u("el-scrollbar"),y=u("el-space"),f=u("el-table-column"),se=u("el-tag"),ce=u("el-switch"),re=u("el-table"),ue=u("el-pagination"),pe=me,_e=ve("loading");return V(),he("div",$e,[n(r,{title:"字典管理",content:"页面数据为 Mock 示例数据，非真实数据。"},{default:d(()=>[n(s,{onClick:t[0]||(t[0]=l=>k.value=!0)},{default:d(()=>[x(" 使用示例 ")]),_:1})]),_:1}),v("div",Ee,[n(pe,{"hide-left-side-toggle":""},{leftSide:d(()=>[n(_,{class:"btns"},{default:d(()=>[n(s,{type:"primary",class:"add",onClick:t[1]||(t[1]=l=>P())},{default:d(()=>[x(" 新增字典 ")]),_:1}),n(s,{onClick:B},{icon:d(()=>[n(c,{name:"ep:refresh"})]),_:1})]),_:1}),n(b,{modelValue:i(a).search,"onUpdate:modelValue":t[2]||(t[2]=l=>i(a).search=l),placeholder:"请输入关键词筛选字典",clearable:"",class:"search"},null,8,["modelValue"]),n(L,{class:"tree"},{default:d(()=>[n(h,{ref_key:"dictionaryRef",ref:M,data:i(a).tree,"filter-node-method":O,"default-expand-all":"",onNodeClick:Z},{default:d(({node:l,data:g})=>[v("div",we,[v("div",{class:"label",title:l.label},E(l.label),9,Se),v("div",Ue,E(g.code),1),v("div",Me,[n(_,null,{default:d(()=>[n(s,{type:"primary",plain:"",size:"default",onClick:w(R=>P(g),["stop"])},{icon:d(()=>[n(c,{name:"ep:plus"})]),_:2},1032,["onClick"]),n(s,{type:"info",plain:"",size:"default",onClick:w(R=>Q(l,g),["stop"])},{icon:d(()=>[n(c,{name:"ep:edit"})]),_:2},1032,["onClick"]),n(s,{type:"danger",plain:"",size:"default",onClick:w(R=>W(l,g),["stop"])},{icon:d(()=>[n(c,{name:"ep:delete"})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])]),_:1})]),default:d(()=>[S(v("div",Be,[n(y,{wrap:""},{default:d(()=>[n(s,{type:"primary",onClick:ie},{icon:d(()=>[n(c,{name:"ep:plus"})]),_:1}),n(s,{type:"danger",disabled:!i(o).selectionDataList.length,onClick:t[3]||(t[3]=l=>de(i(o).selectionDataList))},{icon:d(()=>[n(c,{name:"ep:delete"})]),_:1},8,["disabled"]),n(b,{modelValue:i(o).search.title,"onUpdate:modelValue":t[4]||(t[4]=l=>i(o).search.title=l),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),n(s,{onClick:m},{icon:d(()=>[n(c,{name:"ep:search"})]),_:1})]),_:1}),S((V(),z(re,{ref_key:"dictionaryItemRef",ref:J,data:i(o).dataList,border:"",stripe:"","highlight-current-row":"",height:"100%",onSortChange:ne,onSelectionChange:t[5]||(t[5]=l=>i(o).selectionDataList=l)},{default:d(()=>[n(f,{type:"selection",align:"center",fixed:""}),n(f,{prop:"name",label:"名称"}),n(f,{label:"键值",align:"center",width:"150"},{default:d(l=>[n(se,{type:"info"},{default:d(()=>[x(E(l.row.value),1)]),_:2},1024)]),_:1}),n(f,{label:"状态",width:"100",align:"center"},{default:d(l=>[n(ce,{modelValue:l.row.enable,"onUpdate:modelValue":g=>l.row.enable=g,loading:l.row.enableLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>ee(l.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),n(f,{label:"操作",width:"200",align:"center"},{default:d(l=>[n(s,{type:"primary",size:"small",plain:"",onClick:g=>le(l.row)},{default:d(()=>[x(" 编辑 ")]),_:2},1032,["onClick"]),n(s,{type:"danger",size:"small",plain:"",onClick:g=>oe(l.row)},{default:d(()=>[x(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[_e,i(o).loading]]),n(ue,{"current-page":i(p).page,total:i(p).total,"page-size":i(p).size,"page-sizes":i(p).sizes,layout:i(p).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:te,onCurrentChange:ae},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[A,i(o).search.dictionaryId]]),S(v("div",Pe,Te,512),[[A,!i(o).search.dictionaryId]])]),_:1}),i(a).dialog.visible?(V(),z(xe,{key:0,id:i(a).dialog.id,modelValue:i(a).dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=l=>i(a).dialog.visible=l),"parent-id":i(a).dialog.parentId,tree:i(a).tree,onAddNode:X,onEditNode:Y},null,8,["id","modelValue","parent-id","tree"])):U("",!0),i(o).dialog.visible?(V(),z(Ie,{key:1,id:i(o).dialog.id,modelValue:i(o).dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=l=>i(o).dialog.visible=l),"dictionary-id":i(o).search.dictionaryId,tree:i(a).tree,onSuccess:m},null,8,["id","modelValue","dictionary-id","tree"])):U("",!0),i(k)?(V(),z(Le,{key:2,modelValue:i(k),"onUpdate:modelValue":t[8]||(t[8]=l=>be(k)?k.value=l:null)},null,8,["modelValue"])):U("",!0)])])}}});typeof F=="function"&&F(K);const Je=Ve(K,[["__scopeId","data-v-47ec8ebb"]]);export{Je as default};
