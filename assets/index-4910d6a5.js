import{a as y}from"./dictionary-c7d0e12e.js";import{g as B,h as _,q as h,N as E,r as i,o as T,f as z,w as u,a as d,b as x,u as o,i as M,E as I,_ as S}from"./index-2063e8c9.js";const D=B({__name:"index",props:{modelValue:{type:Boolean,default:!1},parentId:{default:""},id:{default:""},tree:{}},emits:["update:modelValue","addNode","editNode"],setup(k,{emit:C}){const n=k,v=C,m=_(n.modelValue),N=h(()=>n.id===""?"新增字典":"编辑字典");function V(t,l,p=!1){const r=[];return t.forEach(f=>{const a={...f};a.id===l||p?(a.disabled=!0,a.children&&(a.children=V(a.children,l,!0))):(a.disabled=!1,a.children&&(a.children=V(a.children,l,p))),r.push(a)}),r}const w=h(()=>V(n.tree,n.id)),c=_(),e=_({parentId:n.parentId,id:n.id,name:"",code:""}),R=_({name:[{required:!0,message:"请输入字典名称"}],code:[{required:!0,message:"请输入字典编码"}]});E(()=>{n.id!==""&&y.detail(n.id).then(t=>{e.value.id=t.data.id,e.value.name=t.data.name,e.value.code=t.data.code})});function U(){e.value.id===""?c.value&&c.value.validate(t=>{t&&y.create(e.value).then(l=>{I.success({message:"模拟新增成功",center:!0}),v("addNode",{id:l.data.data,label:e.value.name,code:e.value.code}),b()})}):c.value&&c.value.validate(t=>{t&&y.edit(e.value).then(()=>{I.success({message:"模拟编辑成功",center:!0}),v("editNode",{id:e.value.id,label:e.value.name,code:e.value.code},e.value.parentId),b()})})}function b(){m.value=!1}return(t,l)=>{const p=i("el-cascader"),r=i("el-form-item"),f=i("el-input"),a=i("el-form"),g=i("el-button"),q=i("el-dialog");return T(),z(q,{modelValue:o(m),"onUpdate:modelValue":l[3]||(l[3]=s=>M(m)?m.value=s:null),title:o(N),width:"400px","close-on-click-modal":!1,"append-to-body":"","destroy-on-close":"",onClosed:l[4]||(l[4]=s=>v("update:modelValue",!1))},{footer:u(()=>[d(g,{size:"large",onClick:b},{default:u(()=>[x(" 取消 ")]),_:1}),d(g,{type:"primary",size:"large",onClick:U},{default:u(()=>[x(" 确定 ")]),_:1})]),default:u(()=>[d(a,{ref_key:"formRef",ref:c,model:o(e),rules:o(R),"label-width":"80px"},{default:u(()=>[d(r,{label:"父级字典",prop:"parentId"},{default:u(()=>[d(p,{modelValue:o(e).parentId,"onUpdate:modelValue":l[0]||(l[0]=s=>o(e).parentId=s),options:o(w),props:{value:"id",emitPath:!1,checkStrictly:!0},"show-all-levels":!1,placeholder:"请选择父级字典，默认为根字典",clearable:""},null,8,["modelValue","options"])]),_:1}),d(r,{label:"字典名称",prop:"name"},{default:u(()=>[d(f,{modelValue:o(e).name,"onUpdate:modelValue":l[1]||(l[1]=s=>o(e).name=s),placeholder:"请输入字典名称",clearable:""},null,8,["modelValue"])]),_:1}),d(r,{label:"字典编码",prop:"code"},{default:u(()=>[d(f,{modelValue:o(e).code,"onUpdate:modelValue":l[2]||(l[2]=s=>o(e).code=s),placeholder:"请输入字典编码",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});const j=S(D,[["__scopeId","data-v-885c5dc5"]]);export{j as default};
